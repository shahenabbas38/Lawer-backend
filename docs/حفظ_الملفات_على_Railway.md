# حفظ ملفات الاجتهادات على Railway (حل مشكلة "الملف غير متوفر")

على Railway القرص **مؤقت**: أي ملف ترفعه يضيع بعد إعادة النشر أو إعادة التشغيل. عشان الملفات تبقى تحتاج **Volume** (قرص دائم).

---

## 1) إضافة Volume في Railway

1. ادخل على مشروعك في **Railway**.
2. اختر **Service** اللي عليه الباك اند (Laravel).
3. من التبويب **Variables** أو **Settings** ادخل على **Volumes** (أو من القائمة).
4. اضغط **Add Volume** أو **New Volume**.
5. حدد **Mount Path** بحيث يشير لمجلد التخزين العام في Laravel، مثلاً:
   - إذا المشروع في `/app`:  
     **Mount Path:** `/app/storage/app/public`
   - أو للمجلد الكامل:  
     **Mount Path:** `/app/storage`  
   (حسب مكان المشروع على السيرفر؛ عادة يكون `/app` أو `/var/www/html`.)
6. احفظ واعمل **Redeploy** للـ Service.

بعد الـ redeploy، الملفات اللي تُرفع في `storage/app/public` (مثل الاجتهادات) تُحفظ على الـ Volume وما تضيع.

---

## 2) التأكد من الرابط الرمزي للتخزين

على السيرفر لازم يكون تنفيذ **storage:link** مرة واحدة (عند كل deploy أو عبر أمر في الـ start):

```bash
php artisan storage:link
```

- إذا عندك **Start Command** أو **Procfile** عدّلها بحيث تشغّل الأمر قبل تشغيل السيرفر، مثلاً:
  ```bash
  php artisan storage:link && php artisan serve --host=0.0.0.0
  ```
- أو شغّله يدوياً مرة واحدة من **Railway Shell** (إن وُجد).

---

## 3) بعد التعديل

1. اعمل **Redeploy** للباك اند.
2. من لوحة الأدمن ارفع **اجتهاد جديد** (ملف).
3. من جهة المستخدم افتح الاجتهاد — المفروض الملف يفتح وما تظهر رسالة "الملف غير متوفر".

---

## إذا Volume غير متاح أو معقد

يمكن استخدام تخزين خارجي (مثل **AWS S3**) وربط Laravel به؛ الملفات تبقى على S3 والرابط يكون من هناك. هذا يحتاج إعداد إضافي في `config/filesystems.php` ومتغيرات البيئة.

---

**الخلاصة:** رسالة "الملف غير متوفر على الاستضافة" تعني أن الملف غير موجود على قرص السيرفر. عشان يحلّ الموضوع على Railway: إضافة **Volume** لمجلد التخزين + تنفيذ **storage:link** ثم إعادة رفع الملف وتجربة الفتح من المستخدم.
